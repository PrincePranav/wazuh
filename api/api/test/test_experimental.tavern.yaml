---
test_name: GET /experimental/syscheck

stages:

  - name: Request

    request:
      url: http://localhost:55000/experimental/syscheck
      method: GET

    response:
      status_code: 200
      body:
        message: !anystr

---
test_name: GET /experimental/ciscat/results

stages:

  - name: Request

    request:
      url: http://localhost:55000/experimental/ciscat/results
      method: GET

    response:
      status_code: 200
      body:
        data:
          totalItems: !anyint
          items: !anything

---
test_name: GET /experimental/syscollector/hardware

stages:

  - name: Request

    request:
      url: http://localhost:55000/experimental/syscollector/hardware
      method: GET

    response:
      status_code: 200
      body:
        data:
          totalItems: !anyint
          items: !anything

  - name: Filters -> limit=1

    request:
      url: http://localhost:55000/experimental/syscollector/hardware
      method: GET
      params:
        limit: 1

    response:
      status_code: 200
      body:
        data:
          totalItems: 1
          items:
            - cpu:
                core: !anyint
                mhz: !anyfloat
                name: !anystr
              ram:
                free: !anyint
                total: !anyint
                usage: !anyint
              scan:
                id: !anyint
                time: !anystr
              board_serial: !anystr
              agent_id: !anystr

  - name: Filters -> agent_id=000

    request:
      url: http://localhost:55000/experimental/syscollector/hardware
      method: GET
      params:
        agent_id: '000'

    response:
      status_code: 200
      body:
        data:
          totalItems: !anyint
          items: !anything


---
test_name: GET /experimental/syscollector/netaddr

stages:

  - name: Request

    request:
      url: http://localhost:55000/experimental/syscollector/netaddr
      method: GET

    response:
      status_code: 200
      body:
        data:
          totalItems: 1
          items:
            - cpu:
                core: !anyint
                mhz: !anyfloat
                name: !anystr
              ram:
                free: !anyint
                total: !anyint
                usage: !anyint
              scan:
                id: !anyint
                time: !anystr
              board_serial: !anystr
              agent_id: !anystr

  - name: Filters -> limit=1

    request:
      url: http://localhost:55000/experimental/syscollector/netaddr
      method: GET
      params:
        limit: 1

    response:
      status_code: 200
      body:
        data:
          totalItems: 1
          items:
            - proto: !anystr
              iface: !anystr
              scan_id: !anyint
              address: !anystr
              netmask: !anystr
              agent_id: !anystr

---
test_name: GET /experimental/syscollector/netiface

stages:

  - name: Request

    request:
      url: http://localhost:55000/experimental/syscollector/netiface
      method: GET

    response:
      status_code: 200
      body:
        data:
          totalItems: !anyint
          items: !anything

  - name: Filters -> limit=1

    request:
      url: http://localhost:55000/experimental/syscollector/netiface
      method: GET
      parms:
        limit: 1

    response:
      status_code: 200
      body:
        data:
          totalItems: !anyint
          items:
            - rx:
                bytes: !anyint
                dropped: !anyint
                errors: !anyint
                packets: !anyint
              scan:
                id: !anyint
                time: !anystr
              tx:
                bytes: !anyint
                dropped: !anyint
                errors: !anyint
                packets: !anyint
              mac: !anystr
              name: !anystr
              type: !anystr
              mtu: !anyint
              state: !anystr
              agent_id: !anystr

---
test_name: GET /experimental/syscollector/netproto

stages:

  - name: Request

    request:
      url: http://localhost:55000/experimental/syscollector/netproto
      method: GET

    response:
      status_code: 200
      body:
        data:
          totalItems: !anyint
          items: !anything

  - name: Filters -> limit=1

    request:
      url: http://localhost:55000/experimental/syscollector/netproto
      method: GET
      params:
        limit: 1

    response:
      status_code: 200
      body:
        data:
          totalItems: !anyint
          items:
            - iface:
              scan_id: !anyint
              type: !anystr
              dhcp: !anystr
              agent_id: !anystr

---
test_name: GET /experimental/syscollector/os

stages:

  - name: Request

    request:
      url: http://localhost:55000/experimental/syscollector/os
      method: GET

    response:
      status_code: 200
      body:
        data:
          totalItems: !anyint
          items: !anything

  - name: Filters -> limit=1

    request:
      url: http://localhost:55000/experimental/syscollector/os
      method: GET
      params:
        limit: 1

    response:
      status_code: 200
      body:
        data:
          totalItems: !anyint
          items:
            - os:
                codename: !anystr
                major: !anystr
                minor: !anystr
                name: !anystr
                platform: !anystr
                version: !anystr
              scan:
                id: !anyint
                time: !anystr
              release: !anystr
              architecture: !anystr
              version: !anystr
              sysname: !anystr
              hostname: !anystr
              agent_id: !anystr

---
test_name: GET /experimental/syscollector/packages

stages:

  - name: Request

    request:
      url: http://localhost:55000/experimental/syscollector/packages
      method: GET

    response:
      status_code: 200
      body:
        data:
          totalItems: !anyint
          items: !anything

  - name: Filters -> limit=1

    request:
      url: http://localhost:55000/experimental/syscollector/packages
      method: GET
      params:
        limit: 1

    response:
      status_code: 200
      body:
        data:
          totalItems: !anyint
          items:
            - scan:
                id: !anyint
                time: !anystr
              name: !anystr
              section: !anystr
              priority: !anystr
              size: !anyint
              description: !anystr
              architecture: !anystr
              multiarch: !anystr
              vendor: !anystr
              version: !anystr
              format: !anystr
              agent_id: !anystr

---
test_name: GET /experimental/syscollector/ports

stages:

  - name: Request

    request:
      url: http://localhost:55000/experimental/syscollector/ports
      method: GET

    response:
      status_code: 200
      body:
        data:
          totalItems: !anyint
          items: !anything

  - name: Filters -> limit=1

    request:
      url: http://localhost:55000/experimental/syscollector/ports
      method: GET
      params:
        limit: 1

    response:
      status_code: 200
      body:
        data:
          totalItems: !anyint
          items:
            - local:
                ip: !anyint
                port: !anyint
              remote:
                ip: !anyint
                port: !anyint
              scan:
                id: !anyint
                time: !anystr
              state: !anystr
              protocol: !anystr
              rx_queue: !anyint
              tx_queue: !anyint
              inode: !anyint

---
test_name: GET /experimental/syscollector/processes

stages:

  - name: Request

    request:
      url: http://localhost:55000/experimental/syscollector/processes
      method: GET

    response:
      status_code: 200
      body:
        data:
          totalItems: !anyint
          items: !anything

  - name: Filters -> limit=1

    request:
      url: http://localhost:55000/experimental/syscollector/processes
      method: GET
      params:
        limit: 1

    response:
      status_code: 200
      body:
        data:
          totalItems: !anyint
          items:
            - scan:
                id: !anyint
                time: !anystr
              fgroup: !anystr
              state: !anystr
              priority: !anyint
              suser: !anystr
              ppid: !anyint
              vm_size: !anyint
              session: !anyint
              pid: !anystr
              nlwp: !anyint
              name: !anystr
              euser: !anystr
              sgroup: !anystr
              size: !anyint
              stime: !anyint
              nice: !anyint
              share: !anyint
              processor: 1
              ruser: !anystr
              egroup: !anystr
              rgroup: !anystr
              pgrp: !anyint
              resident: !anyint
              utime: !anyint
              tgid: !anyint
              start_time: !anyint
              tty: !anyint
              agent_id: !anystr
