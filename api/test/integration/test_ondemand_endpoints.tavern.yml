---
test_name: GET /cluster/{node_id}/configuration/{component}/{configuration}

includes:
  - !include common.yaml

stages:
  - type: ref
    id: login_get_token
  - name: Try to show the config of analisys through a worker

    request:
      url: "{protocol:s}://{host:s}:{port:d}/cluster/worker1/configuration/analysis/global"
      headers:
        Authorization: "Bearer {test_login_token}"
      method: GET

    response:
      status_code: 200
      body:
        data:
          global:
            alerts_log: !anystr
            email_notification: !anystr
            host_information: !anyint
            integrity_checking: !anyint
            jsonout_output: !anystr
            logall: !anystr
            logall_json: !anystr
            max_output_size: !anyint
            memory_size: !anyint
            prelude_output: !anystr
            rootkit_detection: !anyint
            rotate_interval: !anyint
            stats: !anyint
            white_list: !anything
            zeromq_output: !anystr

  - name: Try to show the config of active response

    request:
      url: "{protocol:s}://{host:s}:{port:d}/cluster/master-node/configuration/analysis/active_response"
      headers:
        Authorization: "Bearer {test_login_token}"
      method: GET

    response:
      status_code: 200
      body:
        data:
          active-response: !anything

  - name: Try to show the config of alerts through a worker

    request:
      url: "{protocol:s}://{host:s}:{port:d}/cluster/worker1/configuration/analysis/alerts"
      headers:
        Authorization: "Bearer {test_login_token}"
      method: GET

    response:
      status_code: 200
      body:
        data:
          alerts: !anything

  - name: Try to show commands

    request:
      url: "{protocol:s}://{host:s}:{port:d}/cluster/master-node/configuration/analysis/command"
      headers:
        Authorization: "Bearer {test_login_token}"
      method: GET

    response:
      status_code: 200
      body:
        data:
          command: !anything

  - name: Try to show the config of internal through a worker

    request:
      url: "{protocol:s}://{host:s}:{port:d}/cluster/worker1/configuration/analysis/internal"
      headers:
        Authorization: "Bearer {test_login_token}"
      method: GET

    response:
      status_code: 200
      body:
        data:
          internal:
            analysisd:
              debug: !anyint
              decoder_order_size: !anyint
              default_timeframe: !anyint
              fts_list_size: !anyint
              fts_min_size_for_str: !anyint
              label_cache_maxage: !anyint
              log_fw: !anyint
              min_rotate_interval: !anyint
              rlimit_nofile: !anyint
              show_hidden_labels: !anyint
              stats_maxdiff: !anyint
              stats_mindiff: !anyint
              stats_percent_diff: !anyint
---